<!doctype html>
<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Checkout || Asbab - eCommerce HTML5 Template</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Place favicon.ico in the root directory -->
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">

    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- All css files are included here. -->
    <!-- Bootstrap fremwork main css -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- Owl Carousel min css -->
    <link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/css/owl.theme.default.min.css}">
    <!-- This core.css file contents all plugings css file. -->
    <link rel="stylesheet" th:href="@{/css/core.css}">
    <!-- Theme shortcodes/elements style -->
    <link rel="stylesheet" th:href="@{/css/shortcode/shortcodes.css}">
    <!-- Theme main style -->
    <link rel="stylesheet" th:href="@{/style.css}">
    <!-- Responsive css -->
    <link rel="stylesheet" th:href="@{/css/responsive.css}">
    <!-- User style -->
    <link rel="stylesheet" th:href="@{/css/custom.css}">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Bootstrap core CSS -->
    <link th:href="@{/checkout/css/bootstrap.min.css}" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link th:href="@{/checkout/css/mdb.min.css}" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link th:href="@{/checkout/css/style.min.css}" rel="stylesheet">
    <!-- Modernizr JS -->
    <!-- Modernizr JS -->
    <script th:src="@{/js/vendor/modernizr-3.5.0.min.js}"></script>
</head>

<body>
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->

<!-- Body main wrapper start -->
<div class="wrapper">
    <!-- Start Header Style -->
    <header id="htc__header" class="htc__header__area header--one">
        <!-- Start Mainmenu Area -->
        <div th:replace="~{fragments/menu :: menu}">Header</div>
        <!-- End Mainmenu Area -->
    </header>
    <!-- End Header Area -->
    <div class="body__overlay"></div>
    <!-- Start Offset Wrapper -->
    <div class="offset__wrapper">
        <!-- Start Search Popap -->
        <div class="search__area">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="search__inner">
                            <form action="#" method="get">
                                <input placeholder="Search here... " type="text">
                                <button type="submit"></button>
                            </form>
                            <div class="search__close__btn">
                                <span class="search__close__btn_icon"><i class="zmdi zmdi-close"></i></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Search Popap -->
        <!-- Start Cart Panel -->
        <div class="shopping__cart">
            <div class="shopping__cart__inner">
                <div class="offsetmenu__close__btn">
                    <a href="#"><i class="zmdi zmdi-close"></i></a>
                </div>
                <div class="shp__cart__wrap">
                    <div class="shp__single__product">
                        <div class="shp__pro__thumb">
                            <a href="#">
                                <img th:src="@{images/product-2/sm-smg/1.jpg}" alt="product images">
                            </a>
                        </div>
                        <div class="shp__pro__details">
                            <h2><a href="product-details.html">BO&Play Wireless Speaker</a></h2>
                            <span class="quantity">QTY: 1</span>
                            <span class="shp__price">$105.00</span>
                        </div>
                        <div class="remove__btn">
                            <a href="#" title="Remove this item"><i class="zmdi zmdi-close"></i></a>
                        </div>
                    </div>
                    <div class="shp__single__product">
                        <div class="shp__pro__thumb">
                            <a href="#">
                                <img th:src="@{images/product-2/sm-smg/2.jpg}" alt="product images">
                            </a>
                        </div>
                        <div class="shp__pro__details">
                            <h2><a href="product-details.html">Brone Candle</a></h2>
                            <span class="quantity">QTY: 1</span>
                            <span class="shp__price">$25.00</span>
                        </div>
                        <div class="remove__btn">
                            <a href="#" title="Remove this item"><i class="zmdi zmdi-close"></i></a>
                        </div>
                    </div>
                </div>
                <ul class="shoping__total">
                    <li class="subtotal">Subtotal:</li>
                    <li class="total__price">$130.00</li>
                </ul>
                <ul class="shopping__btn">
                    <li><a href="cart.html">View Cart</a></li>
                    <li class="shp__checkout"><a href="checkout.html">Checkout</a></li>
                </ul>
            </div>
        </div>
        <!-- End Cart Panel -->
    </div>
    <!-- End Offset Wrapper -->
    <!-- Start Bradcaump area -->
    <div class="ht__bradcaump__area"
         style="background: rgba(0, 0, 0, 0) url(/images/bg/logo2.jpg) no-repeat scroll center center / cover ;">
        <div class="ht__bradcaump__wrap">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="bradcaump__inner">
                            <nav class="bradcaump-inner">
                                <a class="breadcrumb-item" href="index.html">Home</a>
                                <span class="brd-separetor"><i class="zmdi zmdi-chevron-right"></i></span>
                                <span class="breadcrumb-item active">checkout</span>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Bradcaump area -->
    <!-- cart-main-area start -->
    <!--Main layout-->
    <main class="mt-5 pt-4">
        <div class="container wow fadeIn">

            <!-- Heading -->
            <h2 class="my-5 h2 text-center">Checkout form</h2>

            <!--Grid row-->
            <div class="row">

                <!--Grid column-->
                <div class="col-md-8 mb-4">

                    <!--Card-->
                    <div class="card">

                        <!--Card content-->
                        <form class="card-body" th:action="@{/payment}" th:object="${orderRequest}" method="post">

                            <!--Grid row-->
                            <div class="row">

                                <!--Grid column-->
                                <div class="col-md-6 mb-2">
                                    <!--firstName-->
                                    <div class="md-form ">
                                        <input type="text" id="firstName" class="form-control" th:field="*{firstName}">
                                        <label for="firstName" class="">First name</label>
                                    </div>

                                </div>
                                <!--Grid column-->

                                <!--Grid column-->
                                <div class="col-md-6 mb-2">

                                    <!--lastName-->
                                    <div class="md-form">
                                        <input type="text" id="lastName" class="form-control" th:field="*{lastName}">
                                        <label for="lastName" class="">Last name</label>
                                    </div>

                                </div>
                                <!--Grid column-->

                            </div>
                            <!--Grid row-->

                            <!--Username-->
                            <!--address-->
                            <div class="md-form mb-5">
                                <label class="">mobile</label>
                                <input type="text" id="mobile" class="form-control" placeholder="1234 Main St"
                                       th:field="*{mobile}">
                            </div>

                            <!--email-->
                            <div class="md-form mb-5">
                                <input type="email" class="form-control" placeholder="youremail@example.com"
                                       th:field="*{email}">
                                <label class="">Email</label>
                            </div>

                            <!--address-->
                            <div class="md-form mb-5">
                                <input type="text" class="form-control" placeholder="1234 Main St" id="diachi">
                                <label  class="">Address</label>
                            </div>
                            <!--Grid row-->
                            <div class="row">
                                <!--Grid column-->
                                <div class="col-lg-4 col-md-12 mb-4">
                                    <label for="city-province">province</label>
                                    <select class="custom-select d-block w-100" id="city-province" required>
                                        <option value='0'>&nbsp;Chọn Tỉnh/Thành Phố...</option>
                                        <option value='01'>&nbspThành phố Hà Nội</option>
                                        <option value='79'>&nbspThành phố Hồ Chí Minh</option>
                                        <option value='31'>&nbspThành phố Hải Phòng</option>
                                        <option value='48'>&nbspThành phố Đà Nẵng</option>
                                        <option value='92'>&nbspThành phố Cần Thơ</option>
                                        <option value='02'>&nbspTỉnh Hà Giang</option>
                                        <option value='04'>&nbspTỉnh Cao Bằng</option>
                                        <option value='06'>&nbspTỉnh Bắc Kạn</option>
                                        <option value='08'>&nbspTỉnh Tuyên Quang</option>
                                        <option value='10'>&nbspTỉnh Lào Cai</option>
                                        <option value='11'>&nbspTỉnh Điện Biên</option>
                                        <option value='12'>&nbspTỉnh Lai Châu</option>
                                        <option value='14'>&nbspTỉnh Sơn La</option>
                                        <option value='15'>&nbspTỉnh Yên Bái</option>
                                        <option value='17'>&nbspTỉnh Hoà Bình</option>
                                        <option value='19'>&nbspTỉnh Thái Nguyên</option>
                                        <option value='20'>&nbspTỉnh Lạng Sơn</option>
                                        <option value='22'>&nbspTỉnh Quảng Ninh</option>
                                        <option value='24'>&nbspTỉnh Bắc Giang</option>
                                        <option value='25'>&nbspTỉnh Phú Thọ</option>
                                        <option value='26'>&nbspTỉnh Vĩnh Phúc</option>
                                        <option value='27'>&nbspTỉnh Bắc Ninh</option>
                                        <option value='30'>&nbspTỉnh Hải Dương</option>
                                        <option value='33'>&nbspTỉnh Hưng Yên</option>
                                        <option value='34'>&nbspTỉnh Thái Bình</option>
                                        <option value='35'>&nbspTỉnh Hà Nam</option>
                                        <option value='36'>&nbspTỉnh Nam Định</option>
                                        <option value='37'>&nbspTỉnh Ninh Bình</option>
                                        <option value='38'>&nbspTỉnh Thanh Hóa</option>
                                        <option value='40'>&nbspTỉnh Nghệ An</option>
                                        <option value='42'>&nbspTỉnh Hà Tĩnh</option>
                                        <option value='44'>&nbspTỉnh Quảng Bình</option>
                                        <option value='45'>&nbspTỉnh Quảng Trị</option>
                                        <option value='46'>&nbspTỉnh Thừa Thiên Huế</option>
                                        <option value='49'>&nbspTỉnh Quảng Nam</option>
                                        <option value='51'>&nbspTỉnh Quảng Ngãi</option>
                                        <option value='52'>&nbspTỉnh Bình Định</option>
                                        <option value='54'>&nbspTỉnh Phú Yên</option>
                                        <option value='56'>&nbspTỉnh Khánh Hòa</option>
                                        <option value='58'>&nbspTỉnh Ninh Thuận</option>
                                        <option value='60'>&nbspTỉnh Bình Thuận</option>
                                        <option value='62'>&nbspTỉnh Kon Tum</option>
                                        <option value='64'>&nbspTỉnh Gia Lai</option>
                                        <option value='66'>&nbspTỉnh Đắk Lắk</option>
                                        <option value='67'>&nbspTỉnh Đắk Nông</option>
                                        <option value='68'>&nbspTỉnh Lâm Đồng</option>
                                        <option value='70'>&nbspTỉnh Bình Phước</option>
                                        <option value='72'>&nbspTỉnh Tây Ninh</option>
                                        <option value='74'>&nbspTỉnh Bình Dương</option>
                                        <option value='75'>&nbspTỉnh Đồng Nai</option>
                                        <option value='77'>&nbspTỉnh Bà Rịa - Vũng Tàu</option>
                                        <option value='80'>&nbspTỉnh Long An</option>
                                        <option value='82'>&nbspTỉnh Tiền Giang</option>
                                        <option value='83'>&nbspTỉnh Bến Tre</option>
                                        <option value='84'>&nbspTỉnh Trà Vinh</option>
                                        <option value='86'>&nbspTỉnh Vĩnh Long</option>
                                        <option value='87'>&nbspTỉnh Đồng Tháp</option>
                                        <option value='89'>&nbspTỉnh An Giang</option>
                                        <option value='91'>&nbspTỉnh Kiên Giang</option>
                                        <option value='93'>&nbspTỉnh Hậu Giang</option>
                                        <option value='94'>&nbspTỉnh Sóc Trăng</option>
                                        <option value='95'>&nbspTỉnh Bạc Liêu</option>
                                        <option value='96'>&nbspTỉnh Cà Mau</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a valid country.
                                    </div>
                                </div>
                                <!--Grid column-->

                                <!--Grid column-->
                                <div class="col-lg-4 col-md-6 mb-4 district-town-select">

                                    <label for="district-town">District</label>
                                    <select class="custom-select d-block w-100" id="district-town" required
                                    >
                                        <option value='0'>&nbsp;Chọn Quận/Huyện...</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please provide a valid state.
                                    </div>

                                </div>
                                <!--Grid column-->

                                <!--Grid column-->
                                <div class="col-lg-4 col-md-6 mb-4 ward-commune-select">

                                    <label for="ward-commune">Ward commune</label>
                                    <select class="custom-select d-block w-100" id="ward-commune" required
                                    >
                                        <option value='0'>&nbsp;Chọn Phường/Xã...</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please provide a valid state.
                                    </div>

                                </div>
                                <div class="col-lg-4 col-md-6 mb-4 ward-commune-select">
                                    <label>Phí vận chuyển</label>
                                    <select name="shopping" id="shopping">
                                        <option value="17.820">Shopee Express: 17.820đ</option>
                                        <option value="30.202">Giao Hàng Nhanh:20.000đ</option>
                                        <option value="25.122">Ninja Van:25.122</option>
                                    </select>
                                </div>
                                <input  style="display: none" class="form-control"
                                        th:field="*{address}" id="address1">
                                <input  style="display: none" class="form-control"
                                        th:field="*{shipping}" id="ship">
                            </div>
                            <!--Grid row-->
                            <hr>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="same-address">
                                <label class="custom-control-label" for="same-address">Shipping address is the same as
                                    my billing address</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="save-info">
                                <label class="custom-control-label" for="save-info">Save this information for next
                                    time</label>
                            </div>
                            <hr>
                            <hr class="mb-4">
                            <button type="submit" class="btn btn-primary" onclick="Show()">Continue to checkout</button>
                        </form>
                    </div>
                    <!--/.Card-->

                </div>
                <!--Grid column-->

                <!--Grid column-->
                <div class="col-md-4 mb-4">

                    <!-- Heading -->
                    <h4 class="d-flex justify-content-between align-items-center mb-3">
                        <span class="text-muted">Your cart</span>
                        <span class="badge badge-secondary badge-pill" th:text="${quantity}"></span>
                    </h4>

                    <!-- Cart -->
                    <ul class="list-group mb-3 z-depth-1">
                        <li class="list-group-item d-flex justify-content-between lh-condensed" th:each="cartItem :${cartItemDTOS}">
                            <div>
                                <h6 class="my-0" th:text="${cartItem.product.name}">Product name</h6>
                                <small class="text-muted" th:text="${cartItem.product.metaTitle}">Brief description</small>
                            </div>
                            <span class="text-muted" th:text="${cartItem.product.price}">$12</span>
                        </li>
                        <li class="list-group-item d-flex justify-co`ntent-between">
                            <span>Total (VNĐ)</span>
                            <strong th:text="${tong}"></strong>
                        </li>
                    </ul>
                    <!-- Cart -->

                    <!-- Promo code -->
                    <form class="card p-2">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Promo code"
                                   aria-label="Recipient's username" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-secondary btn-md waves-effect m-0" type="button">Redeem</button>
                            </div>
                        </div>
                    </form>
                    <!-- Promo code -->

                </div>
                <!--Grid column-->

            </div>
            <!--Grid row-->

        </div>
    </main>
    <!--Main layout-->
    <!-- cart-main-area end -->
    <!-- Start Footer Area -->
    <div th:insert="~{fragments/footer :: footer}">&copy; 2017 The Static Templates</div>
    <!-- End Footer Style -->
</div>
<!-- Body main wrapper end -->

<!-- Placed js at the end of the document so the pages load faster -->

<!-- Placed js at the end of the document so the pages load faster -->
<!-- jquery latest version -->
<script th:src="@{/js/vendor/jquery-3.2.1.min.js}"></script>
<!-- Bootstrap framework js -->
<script th:src="@{/js/bootstrap.min.js}"></script>
<!-- All js plugins included in this file. -->
<script th:src="@{/js/plugins.js}"></script>
<script th:src="@{/js/slick.min.js}"></script>
<script th:src="@{/js/owl.carousel.min.js}"></script>
<!-- Waypoints.min.js. -->
<script th:src="@{/js/waypoints.min.js}"></script>
<!-- Main js file that contents all jQuery plugins activation. -->
<script th:src="@{/js/main.js}"></script>
<script type="text/javascript" th:src="@{/checkout/js/jquery-3.4.1.min.js}"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" th:src="@{/checkout/js/popper.min.js}"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" th:src="@{/checkout/js/bootstrap.min.js}"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" th:src="@{/checkout/js/mdb.min.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- Initializations -->
<script type="text/javascript">
    // Animations initialization
    new WOW().init();
</script>
<script>
    const apiUrl = "https://sheltered-anchorage-60344.herokuapp.com";
    const apiEndpointDistrict = apiUrl + '/district/?idProvince=';
    const apiEndpointCommune = apiUrl + '/commune/?idDistrict=';

    async function getDistrict(idProvince) {
        const {data: districtList} = await axios.get(apiEndpointDistrict + idProvince);
        return districtList
    }

    async function getCommune(idDistrict) {
        const {data: communeList} = await axios.get(apiEndpointCommune + idDistrict);
        return communeList
    }

    document.querySelector('#city-province').addEventListener("change", async () => {// get district and town when changing city/province
        const idProvince = document.querySelector('#city-province').value;
        const districtList = await getDistrict(idProvince) || [];
        let outputDistrict = "<option value='0'>&nbspChọn Quận/Huyện...</option>";
        let outputCommune = "<option value='0'>&nbspChọn Phường/Xã...</option>";
        for (let i = 0; i < districtList.length; i++) {
            if (districtList[i].idProvince === idProvince) {
                outputDistrict += `<option value='${districtList[i].idDistrict}'>&nbsp${districtList[i].name}</option>`;
            }
        }
        document.querySelector('#district-town').innerHTML = outputDistrict;
        document.querySelector('#ward-commune').innerHTML = outputCommune;
        document.querySelector('.district-town-select > span').style.display = "none";
    })

    document.querySelector('#district-town').addEventListener("change", async () => {// get ward and commune when changing district/town
        const idDistrict = document.querySelector('#district-town').value;
        const communeList = await getCommune(idDistrict) || [];
        let outputCommune = "<option value='0'>&nbspChọn Phường/Xã...</option>";
        for (let i = 0; i < communeList.length; i++) {
            if (communeList[i].idDistrict === idDistrict) {
                outputCommune += `<option value='${communeList[i].idCommune}'>&nbsp${communeList[i].name}</option>`;
            }
        }
        document.querySelector('#ward-commune').innerHTML = outputCommune;
        document.querySelector('.ward-commune-select > span').style.display = "none";
    })
    function Show() {
        let line = document.getElementById("diachi").value;
        let city = document.getElementById("city-province");
        let district = document.getElementById("district-town");
        let shopping = document.getElementById("shopping");
        let wardCommune = document.getElementById("ward-commune");
        let obj = {
            shopping:shopping.options[shopping.selectedIndex].value,
            city: city.options[city.selectedIndex].text,
            district: district.options[district.selectedIndex].text,
            wardCommune: wardCommune.options[wardCommune.selectedIndex].text,
        }
        document.getElementById("ship").value =`${obj.shopping}`;
        document.getElementById("address1").value =line+"-"+`${obj.wardCommune}-${obj.district}-${obj.city}`;
        if(document.getElementById("paypal").checked===true){
            document.getElementById("payment").value = 0;
        }
        else{
            document.getElementById("payment").value = 1;
        }
    }
</script>

</body>

</html>